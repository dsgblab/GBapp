import{_ as D}from"./AppLayout-4bc7c62c.js";import{_ as S}from"./PrimaryButton-e92e2a3c.js";import{_ as T}from"./SecondaryButton-b92cf50a.js";import{a as N}from"./DialogModal-781c5f73.js";import{_ as O}from"./TextInput-5e0f2144.js";import{_ as P}from"./InputError-6fc5082e.js";import{u as z,r as k,a as L,e as F,m as w,s as G}from"./i18n-validators-85d8c3b9.js";import{_ as j}from"./InputLabel-6bc404a8.js";import{_ as H}from"./Checkbox-9fcb9a86.js";import{_ as J}from"./DangerButton-f55927a1.js";import{k as K,i as Q,I as f,L as W,o,c as g,w as p,a as s,D as V,b as i,g as b,e as t,h as u,F as c,t as n,a1 as X,n as C,f as _}from"./app-98320048.js";import{_ as Y}from"./CustomButton-87bec223.js";import{_ as Z}from"./_plugin-vue_export-helper-c27b6911.js";const ee={setup(){return{v$:z()}},components:{Link:K,CustomButton:Y,FontAwesomeIcon:Q,DangerButton:J,Checkbox:H,InputLabel:j,InputError:P,TextInput:O,PrimaryButton:S,SecondaryButton:T,AppLayout:D,DialogModal:N},props:{users:Array,roles:Array,permissions:Array,reports:Array},validations(){return{modal:{form:{id:{requiredIf:k(this.modal.editMode)},name:{required:L},username:{required:L},email:{required:L,email:F},password:{requiredIf:k(this.modal.form.change_password||!this.modal.editMode),minLength:w(8)},confirm_password:{requiredIf:k(this.modal.form.change_password||!this.modal.editMode),sameAs:G(this.modal.form.password),minLength:w(8)},reports:{minLength:w(1)},permissions:{requiredIf:k(this.modal.form.roles.length<1),minLength:w(1)},roles:{requiredIf:k(this.modal.form.permissions.length<1),minLength:w(1)}}}}},data(){return{records:this.users,modal:{title:"",editMode:!1,open:!1,form:{id:"",type:"",name:"",username:"",email:"",change_password:!1,password:"",confirm_password:"",reports:[],permissions:[],roles:[]}}}},methods:{create(){this.modal.open=!0,this.modal.title="Crear Usuario"},edit(m){this.modal={title:"Editar Usuario",editMode:!0,open:!0,form:{id:m.id,type:m.type,name:m.name,username:m.username,email:m.email,change_password:!1,password:"",confirm_password:"",reports:m.reports.map(r=>r.id),permissions:m.permissions.map(r=>r.name),roles:m.roles.map(r=>r.name)}}},store(){this.v$.modal.form.$touch(),this.v$.modal.form.$invalid?this.$swal({icon:"error",title:"ERROR",text:"Verifica que toda la información este correctamente diligenciada"}):axios.post(route("users.store"),this.modal.form).then(m=>{this.closeModal(),this.records=m.data}).catch(m=>{this.$swal({icon:"error",title:"ERROR",text:m.response.data})})},update(){this.v$.modal.form.$touch(),this.v$.modal.form.$invalid?this.$swal({icon:"error",title:"ERROR",text:"Verifica que toda la información este correctamente diligenciada"}):axios.put(route("users.update",this.modal.form.id),this.modal.form).then(m=>{this.closeModal(),this.records=m.data}).catch(m=>{this.$swal({icon:"error",title:"ERROR",text:m.response.data})})},destroy(m){this.$swal({icon:"question",title:"¿Eliminar Usuario?",text:"¡Esta acción no es reversible!",showCancelButton:!0,confirmButtonText:"¡Si, Eliminar!"}).then(r=>{r.isConfirmed&&axios.delete(route("users.destroy",m)).then(h=>{this.records=h.data}).catch(h=>{this.$swal({icon:"error",title:"ERROR",text:h.response.data})})})},closeModal(){this.modal={title:"",editMode:!1,open:!1,form:{id:"",type:"",name:"",username:"",email:"",change_password:!1,password:"",confirm_password:"",reports:[],permissions:[],roles:[]}},this.v$.modal.form.$reset()}}},se={class:"flex flex-row"},oe=s("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Usuarios del sistema ",-1),te={class:"py-12"},re={class:"max-w-8xl mx-6 sm:px-6 lg:px-8"},le={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},ae={class:"py-2 align-middle inline-block min-w-full"},ie={class:"shadow overflow-hidden border-b border-gray-200 sm:rounded-lg"},de={class:"min-w-full divide-y divide-gray-200"},ne=s("thead",{class:"bg-gray-50"},[s("tr",null,[s("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}),s("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tipo "),s("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre "),s("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Usuario "),s("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Correo Electrónico "),s("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Roles Asociados "),s("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Permisos Asociados "),s("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Reportes asociados "),s("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Creado el "),s("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actualizado el ")])],-1),me={class:"bg-white divide-y divide-gray-200"},ce={class:"px-6 py-4 text-center text-sm font-medium"},ue={class:"flex flex-row"},pe={class:"px-6 py-4 text-center text-sm font-medium"},fe={class:"px-6 py-4 text-left text-sm font-medium"},_e={class:"px-6 py-4 text-left text-sm font-medium"},xe={class:"px-6 py-4 text-left text-sm font-medium"},he={class:"px-6 py-4 text-left text-sm font-medium"},ye={class:"text-xs font-semibold inline-block py-1 px-2 rounded text-indigo-600 bg-indigo-200 uppercase last:mr-0 mr-1"},ge={key:1,class:"text-xs font-semibold inline-block py-1 px-2 rounded text-red-600 bg-red-200 uppercase last:mr-0 mr-1"},ve={class:"px-6 py-4 text-left text-sm font-medium"},ke={class:"text-xs font-semibold inline-block py-1 px-2 rounded text-indigo-600 bg-indigo-200 uppercase last:mr-0 mr-1"},we={key:1,class:"text-xs font-semibold inline-block py-1 px-2 rounded text-red-600 bg-red-200 uppercase last:mr-0 mr-1"},be={class:"px-6 py-4 text-left text-sm font-medium"},Ce={class:"text-xs font-semibold inline-block py-1 px-2 rounded text-indigo-600 bg-indigo-200 uppercase last:mr-0 mr-1"},$e={key:1,class:"text-xs font-semibold inline-block py-1 px-2 rounded text-red-600 bg-red-200 uppercase last:mr-0 mr-1"},Ve={class:"px-6 py-4 text-left text-sm font-medium"},Re={class:"px-6 py-4 text-left text-sm font-medium"},Me={class:"mt-4"},qe=s("option",{value:"",disabled:"",selected:""},"Seleccione…",-1),Le=s("option",{value:"customer"},"Cliente",-1),Ue=s("option",{value:"designer"},"Diseñador",-1),Be=[qe,Le,Ue],Ie={class:"mt-4"},Ae={key:0,class:"mt-1"},Ee={class:"mt-4"},De={key:0,class:"mt-1"},Se={class:"mt-4"},Te={key:0,class:"mt-1"},Ne={key:0,class:"block mt-4"},Oe={class:"flex items-center"},Pe=s("span",{class:"ml-2 text-sm text-gray-600"},"Cambiar contraseña",-1),ze={class:"mt-4"},Fe={key:0,class:"mt-1"},Ge={class:"mt-4"},je={key:0,class:"mt-1"},He={class:"mt-4"},Je={class:"grid grid-cols-3 gap-5 mt-2"},Ke={class:"flex items-center"},Qe={class:"ml-2"},We={key:0,class:"mt-1"},Xe={class:"mt-4"},Ye={class:"grid grid-cols-3 gap-5 mt-2"},Ze={class:"flex items-center"},es={class:"ml-2"},ss={key:0,class:"mt-1"},os={class:"mt-4"},ts={class:"grid grid-cols-3 gap-5 mt-2"},rs={class:"flex items-center"},ls={class:"ml-2"},as={key:0,class:"mt-1"};function is(m,r,h,d,a,y){const R=f("font-awesome-icon"),M=f("PrimaryButton"),U=f("Link"),B=f("CustomButton"),x=f("InputLabel"),v=f("TextInput"),$=f("Checkbox"),I=f("SecondaryButton"),A=f("DialogModal"),E=f("AppLayout"),q=W("permission");return o(),g(E,{title:"Usuarios del sistema"},{header:p(()=>[s("div",se,[oe,V((o(),g(M,{type:"button",class:"ml-auto",onClick:y.create},{default:p(()=>[i(R,{icon:"plus",class:"mr-2"}),b(" Crear ")]),_:1},8,["onClick"])),[[q,"user.create"]])])]),default:p(()=>[s("div",te,[s("div",re,[s("div",le,[s("div",ae,[s("div",ie,[s("table",de,[ne,s("tbody",me,[(o(!0),t(c,null,u(a.records,e=>(o(),t("tr",null,[s("td",ce,[s("div",ue,[V((o(),g(U,{href:m.route("users.show",e.id),class:"mr-2 inline-flex items-center px-2 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-25 transition ease-in-out duration-150"},{default:p(()=>[i(R,{icon:["far","pen-to-square"]})]),_:2},1032,["href"])),[[q,"user.edit"]]),V((o(),g(B,{onClick:l=>y.destroy(e.id)},{default:p(()=>[i(R,{icon:["far","trash-can"]})]),_:2},1032,["onClick"])),[[q,"user.destroy"]])])]),s("td",pe,n(e.type),1),s("td",fe,n(e.name),1),s("td",_e,n(e.username),1),s("td",xe,n(e.email),1),s("td",he,[e.roles?(o(!0),t(c,{key:0},u(e.roles.split(", "),l=>(o(),t("span",ye,n(l),1))),256)):(o(),t("span",ge," sin roles asociados "))]),s("td",ve,[e.permissions?(o(!0),t(c,{key:0},u(e.permissions.split(", "),l=>(o(),t("span",ke,n(l),1))),256)):(o(),t("span",we," sin permisos asociados "))]),s("td",be,[e.reports?(o(!0),t(c,{key:0},u(e.reports.split(", "),l=>(o(),t("span",Ce,n(l),1))),256)):(o(),t("span",$e," sin reportes asociados "))]),s("td",Ve,n(e.created_at),1),s("td",Re,n(e.updated_at),1)]))),256))])])])])])])]),i(A,{show:a.modal.open,onClose:y.closeModal},{title:p(()=>[b(n(a.modal.title),1)]),content:p(()=>[s("div",Me,[i(x,{value:"Tipo"}),V(s("select",{class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":r[0]||(r[0]=e=>a.modal.form.type=e),required:""},Be,512),[[X,a.modal.form.type]])]),s("div",Ie,[i(x,{value:"Nombre"}),i(v,{modelValue:a.modal.form.name,"onUpdate:modelValue":r[1]||(r[1]=e=>a.modal.form.name=e),type:"text",class:C(["mt-1 block w-full",{"border-red-500":d.v$.modal.form.name.$error}]),required:"",autocomplete:"off"},null,8,["modelValue","class"]),d.v$.modal.form.name.$error?(o(),t("ul",Ae,[(o(!0),t(c,null,u(d.v$.modal.form.name.$errors,(e,l)=>(o(),t("li",{class:"text-red-500",key:l},n(e.$message),1))),128))])):_("",!0)]),s("div",Ee,[i(x,{value:"Usuario"}),i(v,{modelValue:a.modal.form.username,"onUpdate:modelValue":r[2]||(r[2]=e=>a.modal.form.username=e),type:"text",class:C(["mt-1 block w-full",{"border-red-500":d.v$.modal.form.username.$error}]),required:"",autocomplete:"off"},null,8,["modelValue","class"]),d.v$.modal.form.username.$error?(o(),t("ul",De,[(o(!0),t(c,null,u(d.v$.modal.form.username.$errors,(e,l)=>(o(),t("li",{class:"text-red-500",key:l},n(e.$message),1))),128))])):_("",!0)]),s("div",Se,[i(x,{value:"Correo electrónico"}),i(v,{modelValue:a.modal.form.email,"onUpdate:modelValue":r[3]||(r[3]=e=>a.modal.form.email=e),type:"email",class:C(["mt-1 block w-full",{"border-red-500":d.v$.modal.form.email.$error}]),required:"",autocomplete:"off"},null,8,["modelValue","class"]),d.v$.modal.form.email.$error?(o(),t("ul",Te,[(o(!0),t(c,null,u(d.v$.modal.form.email.$errors,(e,l)=>(o(),t("li",{class:"text-red-500",key:l},n(e.$message),1))),128))])):_("",!0)]),a.modal.editMode?(o(),t("div",Ne,[s("label",Oe,[i($,{checked:a.modal.form.change_password,"onUpdate:checked":r[4]||(r[4]=e=>a.modal.form.change_password=e),name:"change_password"},null,8,["checked"]),Pe])])):_("",!0),a.modal.form.change_password||!a.modal.editMode?(o(),t(c,{key:1},[s("div",ze,[i(x,{value:"Contraseña"}),i(v,{modelValue:a.modal.form.password,"onUpdate:modelValue":r[5]||(r[5]=e=>a.modal.form.password=e),type:"password",class:C(["mt-1 block w-full",{"border-red-500":d.v$.modal.form.password.$error}]),required:"",autocomplete:"off"},null,8,["modelValue","class"]),d.v$.modal.form.password.$error?(o(),t("ul",Fe,[(o(!0),t(c,null,u(d.v$.modal.form.password.$errors,(e,l)=>(o(),t("li",{class:"text-red-500",key:l},n(e.$message),1))),128))])):_("",!0)]),s("div",Ge,[i(x,{value:"Confirmar Contraseña"}),i(v,{modelValue:a.modal.form.confirm_password,"onUpdate:modelValue":r[6]||(r[6]=e=>a.modal.form.confirm_password=e),type:"password",class:C(["mt-1 block w-full",{"border-red-500":d.v$.modal.form.confirm_password.$error}]),required:"",autocomplete:"off"},null,8,["modelValue","class"]),d.v$.modal.form.confirm_password.$error?(o(),t("ul",je,[(o(!0),t(c,null,u(d.v$.modal.form.confirm_password.$errors,(e,l)=>(o(),t("li",{class:"text-red-500",key:l},n(e.$message),1))),128))])):_("",!0)])],64)):_("",!0),s("div",He,[i(x,{value:"Reportes disponibles"}),s("div",Je,[(o(!0),t(c,null,u(h.reports,e=>(o(),t("div",Ke,[i($,{checked:a.modal.form.reports,"onUpdate:checked":r[7]||(r[7]=l=>a.modal.form.reports=l),value:e.id},null,8,["checked","value"]),s("div",Qe,n(e.name),1)]))),256))]),d.v$.modal.form.reports.$error?(o(),t("ul",We,[(o(!0),t(c,null,u(d.v$.modal.form.reports.$errors,(e,l)=>(o(),t("li",{class:"text-red-500",key:l},n(e.$message),1))),128))])):_("",!0)]),s("div",Xe,[i(x,{value:"Roles Disponibles"}),s("div",Ye,[(o(!0),t(c,null,u(h.roles,e=>(o(),t("div",Ze,[i($,{checked:a.modal.form.roles,"onUpdate:checked":r[8]||(r[8]=l=>a.modal.form.roles=l),value:e.name},null,8,["checked","value"]),s("div",es,n(e.name),1)]))),256))]),d.v$.modal.form.roles.$error?(o(),t("ul",ss,[(o(!0),t(c,null,u(d.v$.modal.form.roles.$errors,(e,l)=>(o(),t("li",{class:"text-red-500",key:l},n(e.$message),1))),128))])):_("",!0)]),s("div",os,[i(x,{value:"Permisos Disponibles"}),s("div",ts,[(o(!0),t(c,null,u(h.permissions,e=>(o(),t("div",rs,[i($,{checked:a.modal.form.permissions,"onUpdate:checked":r[9]||(r[9]=l=>a.modal.form.permissions=l),value:e.name},null,8,["checked","value"]),s("div",ls,n(e.name),1)]))),256))]),d.v$.modal.form.permissions.$error?(o(),t("ul",as,[(o(!0),t(c,null,u(d.v$.modal.form.permissions.$errors,(e,l)=>(o(),t("li",{class:"text-red-500",key:l},n(e.$message),1))),128))])):_("",!0)])]),footer:p(()=>[i(I,{onClick:y.closeModal},{default:p(()=>[b(" Cancelar ")]),_:1},8,["onClick"]),a.modal.editMode?(o(),g(M,{key:0,class:"ml-3",onClick:y.update},{default:p(()=>[b(" Actualizar ")]),_:1},8,["onClick"])):(o(),g(M,{key:1,class:"ml-3",onClick:y.store},{default:p(()=>[b(" Guardar ")]),_:1},8,["onClick"]))]),_:1},8,["show","onClose"])]),_:1})}const ks=Z(ee,[["render",is]]);export{ks as default};
