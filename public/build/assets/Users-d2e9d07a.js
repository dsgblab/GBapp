import{_ as L}from"./AppLayout-09551333.js";import{_ as E}from"./PrimaryButton-aeaef532.js";import{_ as S}from"./SecondaryButton-736c1d10.js";import{a as T}from"./DialogModal-605fa433.js";import{_ as N}from"./TextInput-9f00e42d.js";import{_ as O}from"./InputError-e117dfaa.js";import{u as P,r as w,a as b,n as z,e as F,m as C,s as G}from"./index-9291433a.js";import{_ as j}from"./InputLabel-85ed99ea.js";import{_ as H}from"./Checkbox-f6ad087f.js";import{_ as J}from"./DangerButton-e9ba40a2.js";import{i as K,p as x,q as Q,o,c as k,w as f,a as t,s as q,b as d,g as $,e as s,h as u,F as c,t as n,S as W,n as g,f as p}from"./app-633a0e1b.js";import{_ as X}from"./_plugin-vue_export-helper-c27b6911.js";const Y={setup(){return{v$:P()}},components:{FontAwesomeIcon:K,DangerButton:J,Checkbox:H,InputLabel:j,InputError:O,TextInput:N,PrimaryButton:E,SecondaryButton:S,AppLayout:L,DialogModal:T},props:{users:Array,roles:Array,permissions:Array,reports:Array,type_document_identifications:Array},validations(){return{modal:{form:{id:{requiredIf:w(this.modal.editMode)},type_document_identification_id:{required:b},document:{required:b,numeric:z},name:{required:b},username:{required:b},email:{required:b,email:F},password:{requiredIf:w(this.modal.form.change_password||!this.modal.editMode),minLength:C(8)},confirm_password:{requiredIf:w(this.modal.form.change_password||!this.modal.editMode),sameAs:G(this.modal.form.password),minLength:C(8)},reports:{minLength:C(1)},permissions:{requiredIf:w(this.modal.form.roles.length<1),minLength:C(1)},roles:{requiredIf:w(this.modal.form.permissions.length<1),minLength:C(1)}}}}},data(){return{records:this.users,modal:{title:"",editMode:!1,open:!1,form:{id:"",type_document_identification_id:"",document:"",name:"",username:"",email:"",change_password:!1,password:"",confirm_password:"",reports:[],permissions:[],roles:[]}}}},methods:{create(){this.modal.open=!0,this.modal.title="Crear Usuario"},edit(m){this.modal={title:"Editar Usuario",editMode:!0,open:!0,form:{id:m.id,type_document_identification_id:m.type_identification.id,document:m.document,name:m.name,username:m.username,email:m.email,change_password:!1,password:"",confirm_password:"",reports:m.reports.map(l=>l.id),permissions:m.permissions.map(l=>l.name),roles:m.roles.map(l=>l.name)}}},store(){this.v$.modal.form.$touch(),this.v$.modal.form.$invalid?this.$swal({icon:"error",title:"ERROR",text:"Verifica que toda la información este correctamente diligenciada"}):axios.post(route("users.store"),this.modal.form).then(m=>{this.closeModal(),this.records=m.data}).catch(m=>{this.$swal({icon:"error",title:"ERROR",text:m.response.data})})},update(){this.v$.modal.form.$touch(),this.v$.modal.form.$invalid?this.$swal({icon:"error",title:"ERROR",text:"Verifica que toda la información este correctamente diligenciada"}):axios.put(route("users.update",this.modal.form.id),this.modal.form).then(m=>{this.closeModal(),this.records=m.data}).catch(m=>{this.$swal({icon:"error",title:"ERROR",text:m.response.data})})},destroy(m){this.$swal({icon:"question",title:"¿Eliminar Usuario?",text:"¡Esta acción no es reversible!",showCancelButton:!0,confirmButtonText:"¡Si, Eliminar!"}).then(l=>{l.isConfirmed&&axios.delete(route("users.destroy",m)).then(h=>{this.records=h.data}).catch(h=>{this.$swal({icon:"error",title:"ERROR",text:h.response.data})})})},closeModal(){this.modal={title:"",editMode:!1,open:!1,form:{id:"",type_document_identification_id:"",document:"",name:"",username:"",email:"",change_password:!1,password:"",confirm_password:"",reports:[],permissions:[],roles:[]}},this.v$.modal.form.$reset()}}},Z={class:"flex flex-row"},ee=t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Usuarios del sistema ",-1),oe={class:"py-12"},te={class:"max-w-8xl mx-6 sm:px-6 lg:px-8"},se={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},re={class:"py-2 align-middle inline-block min-w-full"},le={class:"shadow overflow-hidden border-b border-gray-200 sm:rounded-lg"},ae={class:"min-w-full divide-y divide-gray-200"},ie=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Documento "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tipo Documento "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Usuario "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Correo Electrónico "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Roles Asociados "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Permisos Asociados "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Reportes asociados "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Creado el "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actualizado el "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"})])],-1),de={class:"bg-white divide-y divide-gray-200"},ne={class:"px-6 py-4 text-left text-sm font-medium"},me={class:"px-6 py-4 text-left text-sm font-medium"},ce={class:"px-6 py-4 text-left text-sm font-medium"},ue={class:"px-6 py-4 text-left text-sm font-medium"},pe={class:"px-6 py-4 text-left text-sm font-medium"},fe={class:"px-6 py-4 text-left text-sm font-medium"},_e={class:"text-xs font-semibold inline-block py-1 px-2 rounded text-indigo-600 bg-indigo-200 uppercase last:mr-0 mr-1"},xe={key:1,class:"text-xs font-semibold inline-block py-1 px-2 rounded text-red-600 bg-red-200 uppercase last:mr-0 mr-1"},he={class:"px-6 py-4 text-left text-sm font-medium"},ye={class:"text-xs font-semibold inline-block py-1 px-2 rounded text-indigo-600 bg-indigo-200 uppercase last:mr-0 mr-1"},ge={key:1,class:"text-xs font-semibold inline-block py-1 px-2 rounded text-red-600 bg-red-200 uppercase last:mr-0 mr-1"},ve={class:"px-6 py-4 text-left text-sm font-medium"},ke={class:"text-xs font-semibold inline-block py-1 px-2 rounded text-indigo-600 bg-indigo-200 uppercase last:mr-0 mr-1"},we={key:1,class:"text-xs font-semibold inline-block py-1 px-2 rounded text-red-600 bg-red-200 uppercase last:mr-0 mr-1"},be={class:"px-6 py-4 text-left text-sm font-medium"},Ce={class:"px-6 py-4 text-left text-sm font-medium"},$e={class:"px-6 py-4 text-center text-sm font-medium"},Ve={class:"mt-4"},qe=t("option",{value:"",disabled:"",selected:""},"Seleccione…",-1),Re=["value"],Ue={key:0,class:"mt-1"},Me={class:"mt-4"},Ae={key:0,class:"mt-1"},Be={class:"mt-4"},Ie={key:0,class:"mt-1"},De={class:"mt-4"},Le={key:0,class:"mt-1"},Ee={class:"mt-4"},Se={key:0,class:"mt-1"},Te={key:0,class:"block mt-4"},Ne={class:"flex items-center"},Oe=t("span",{class:"ml-2 text-sm text-gray-600"},"Cambiar contraseña",-1),Pe={class:"mt-4"},ze={key:0,class:"mt-1"},Fe={class:"mt-4"},Ge={key:0,class:"mt-1"},je={class:"mt-4"},He={class:"grid grid-cols-3 gap-5 mt-2"},Je={class:"flex items-center"},Ke={class:"ml-2"},Qe={key:0,class:"mt-1"},We={class:"mt-4"},Xe={class:"grid grid-cols-3 gap-5 mt-2"},Ye={class:"flex items-center"},Ze={class:"ml-2"},eo={key:0,class:"mt-1"},oo={class:"mt-4"},to={class:"grid grid-cols-3 gap-5 mt-2"},so={class:"flex items-center"},ro={class:"ml-2"},lo={key:0,class:"mt-1"};function ao(m,l,h,i,a,y){const R=x("font-awesome-icon"),U=x("PrimaryButton"),A=x("SecondaryButton"),B=x("DangerButton"),_=x("InputLabel"),v=x("TextInput"),V=x("Checkbox"),I=x("DialogModal"),D=x("AppLayout"),M=Q("permission");return o(),k(D,{title:"Usuarios del sistema"},{header:f(()=>[t("div",Z,[ee,q((o(),k(U,{type:"button",class:"ml-auto",onClick:y.create},{default:f(()=>[d(R,{icon:"plus",class:"mr-2"}),$(" Crear ")]),_:1},8,["onClick"])),[[M,"user.create"]])])]),default:f(()=>[t("div",oe,[t("div",te,[t("div",se,[t("div",re,[t("div",le,[t("table",ae,[ie,t("tbody",de,[(o(!0),s(c,null,u(a.records,e=>(o(),s("tr",null,[t("td",ne,n(e.document),1),t("td",me,n(e.type_identification.name),1),t("td",ce,n(e.name),1),t("td",ue,n(e.username),1),t("td",pe,n(e.email),1),t("td",fe,[e.roles.length>0?(o(!0),s(c,{key:0},u(e.roles,r=>(o(),s("span",_e,n(r.name),1))),256)):(o(),s("span",xe," sin roles asociados "))]),t("td",he,[e.permissions.length>0?(o(!0),s(c,{key:0},u(e.permissions,r=>(o(),s("span",ye,n(r.name),1))),256)):(o(),s("span",ge," sin permisos asociados "))]),t("td",ve,[e.reports.length>0?(o(!0),s(c,{key:0},u(e.reports,r=>(o(),s("span",ke,n(r.name),1))),256)):(o(),s("span",we," sin reportes asociados "))]),t("td",be,n(e.created_at),1),t("td",Ce,n(e.updated_at),1),t("td",$e,[q((o(),k(A,{class:"mr-2",onClick:r=>y.edit(e)},{default:f(()=>[d(R,{icon:["far","pen-to-square"]})]),_:2},1032,["onClick"])),[[M,"user.edit"]]),q((o(),k(B,{onClick:r=>y.destroy(e.id)},{default:f(()=>[d(R,{icon:["far","trash-can"]})]),_:2},1032,["onClick"])),[[M,"user.destroy"]])])]))),256))])])])])])])]),d(I,{show:a.modal.open,onClose:y.closeModal},{title:f(()=>[$(n(a.modal.title),1)]),content:f(()=>[t("div",Ve,[d(_,{value:"Tipo Documento"}),q(t("select",{class:g(["border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full",{"border-red-500":i.v$.modal.form.type_document_identification_id.$error}]),"onUpdate:modelValue":l[0]||(l[0]=e=>a.modal.form.type_document_identification_id=e),required:""},[qe,(o(!0),s(c,null,u(h.type_document_identifications,e=>(o(),s("option",{value:e.id},n(e.name),9,Re))),256))],2),[[W,a.modal.form.type_document_identification_id]]),i.v$.modal.form.name.$error?(o(),s("ul",Ue,[(o(!0),s(c,null,u(i.v$.modal.form.name.$errors,(e,r)=>(o(),s("li",{class:"text-red-500",key:r},n(e.$message),1))),128))])):p("",!0)]),t("div",Me,[d(_,{value:"CC/NIT"}),d(v,{modelValue:a.modal.form.document,"onUpdate:modelValue":l[1]||(l[1]=e=>a.modal.form.document=e),type:"text",class:g(["mt-1 block w-full",{"border-red-500":i.v$.modal.form.document.$error}]),required:"",autocomplete:"off"},null,8,["modelValue","class"]),i.v$.modal.form.document.$error?(o(),s("ul",Ae,[(o(!0),s(c,null,u(i.v$.modal.form.document.$errors,(e,r)=>(o(),s("li",{class:"text-red-500",key:r},n(e.$message),1))),128))])):p("",!0)]),t("div",Be,[d(_,{value:"Nombre"}),d(v,{modelValue:a.modal.form.name,"onUpdate:modelValue":l[2]||(l[2]=e=>a.modal.form.name=e),type:"text",class:g(["mt-1 block w-full",{"border-red-500":i.v$.modal.form.name.$error}]),required:"",autocomplete:"off"},null,8,["modelValue","class"]),i.v$.modal.form.name.$error?(o(),s("ul",Ie,[(o(!0),s(c,null,u(i.v$.modal.form.name.$errors,(e,r)=>(o(),s("li",{class:"text-red-500",key:r},n(e.$message),1))),128))])):p("",!0)]),t("div",De,[d(_,{value:"Usuario"}),d(v,{modelValue:a.modal.form.username,"onUpdate:modelValue":l[3]||(l[3]=e=>a.modal.form.username=e),type:"text",class:g(["mt-1 block w-full",{"border-red-500":i.v$.modal.form.username.$error}]),required:"",autocomplete:"off"},null,8,["modelValue","class"]),i.v$.modal.form.username.$error?(o(),s("ul",Le,[(o(!0),s(c,null,u(i.v$.modal.form.username.$errors,(e,r)=>(o(),s("li",{class:"text-red-500",key:r},n(e.$message),1))),128))])):p("",!0)]),t("div",Ee,[d(_,{value:"Correo electrónico"}),d(v,{modelValue:a.modal.form.email,"onUpdate:modelValue":l[4]||(l[4]=e=>a.modal.form.email=e),type:"email",class:g(["mt-1 block w-full",{"border-red-500":i.v$.modal.form.email.$error}]),required:"",autocomplete:"off"},null,8,["modelValue","class"]),i.v$.modal.form.email.$error?(o(),s("ul",Se,[(o(!0),s(c,null,u(i.v$.modal.form.email.$errors,(e,r)=>(o(),s("li",{class:"text-red-500",key:r},n(e.$message),1))),128))])):p("",!0)]),a.modal.editMode?(o(),s("div",Te,[t("label",Ne,[d(V,{checked:a.modal.form.change_password,"onUpdate:checked":l[5]||(l[5]=e=>a.modal.form.change_password=e),name:"change_password"},null,8,["checked"]),Oe])])):p("",!0),a.modal.form.change_password||!a.modal.editMode?(o(),s(c,{key:1},[t("div",Pe,[d(_,{value:"Contraseña"}),d(v,{modelValue:a.modal.form.password,"onUpdate:modelValue":l[6]||(l[6]=e=>a.modal.form.password=e),type:"password",class:g(["mt-1 block w-full",{"border-red-500":i.v$.modal.form.password.$error}]),required:"",autocomplete:"off"},null,8,["modelValue","class"]),i.v$.modal.form.password.$error?(o(),s("ul",ze,[(o(!0),s(c,null,u(i.v$.modal.form.password.$errors,(e,r)=>(o(),s("li",{class:"text-red-500",key:r},n(e.$message),1))),128))])):p("",!0)]),t("div",Fe,[d(_,{value:"Confirmar Contraseña"}),d(v,{modelValue:a.modal.form.confirm_password,"onUpdate:modelValue":l[7]||(l[7]=e=>a.modal.form.confirm_password=e),type:"password",class:g(["mt-1 block w-full",{"border-red-500":i.v$.modal.form.confirm_password.$error}]),required:"",autocomplete:"off"},null,8,["modelValue","class"]),i.v$.modal.form.confirm_password.$error?(o(),s("ul",Ge,[(o(!0),s(c,null,u(i.v$.modal.form.confirm_password.$errors,(e,r)=>(o(),s("li",{class:"text-red-500",key:r},n(e.$message),1))),128))])):p("",!0)])],64)):p("",!0),t("div",je,[d(_,{value:"Reportes disponibles"}),t("div",He,[(o(!0),s(c,null,u(h.reports,e=>(o(),s("div",Je,[d(V,{checked:a.modal.form.reports,"onUpdate:checked":l[8]||(l[8]=r=>a.modal.form.reports=r),value:e.id},null,8,["checked","value"]),t("div",Ke,n(e.name),1)]))),256))]),i.v$.modal.form.reports.$error?(o(),s("ul",Qe,[(o(!0),s(c,null,u(i.v$.modal.form.reports.$errors,(e,r)=>(o(),s("li",{class:"text-red-500",key:r},n(e.$message),1))),128))])):p("",!0)]),t("div",We,[d(_,{value:"Roles Disponibles"}),t("div",Xe,[(o(!0),s(c,null,u(h.roles,e=>(o(),s("div",Ye,[d(V,{checked:a.modal.form.roles,"onUpdate:checked":l[9]||(l[9]=r=>a.modal.form.roles=r),value:e.name},null,8,["checked","value"]),t("div",Ze,n(e.name),1)]))),256))]),i.v$.modal.form.roles.$error?(o(),s("ul",eo,[(o(!0),s(c,null,u(i.v$.modal.form.roles.$errors,(e,r)=>(o(),s("li",{class:"text-red-500",key:r},n(e.$message),1))),128))])):p("",!0)]),t("div",oo,[d(_,{value:"Permisos Disponibles"}),t("div",to,[(o(!0),s(c,null,u(h.permissions,e=>(o(),s("div",so,[d(V,{checked:a.modal.form.permissions,"onUpdate:checked":l[10]||(l[10]=r=>a.modal.form.permissions=r),value:e.name},null,8,["checked","value"]),t("div",ro,n(e.name),1)]))),256))]),i.v$.modal.form.permissions.$error?(o(),s("ul",lo,[(o(!0),s(c,null,u(i.v$.modal.form.permissions.$errors,(e,r)=>(o(),s("li",{class:"text-red-500",key:r},n(e.$message),1))),128))])):p("",!0)])]),footer:f(()=>[d(A,{onClick:y.closeModal},{default:f(()=>[$(" Cancelar ")]),_:1},8,["onClick"]),a.modal.editMode?(o(),k(U,{key:0,class:"ml-3",onClick:y.update},{default:f(()=>[$(" Actualizar ")]),_:1},8,["onClick"])):(o(),k(U,{key:1,class:"ml-3",onClick:y.store},{default:f(()=>[$(" Guardar ")]),_:1},8,["onClick"]))]),_:1},8,["show","onClose"])]),_:1})}const vo=X(Y,[["render",ao]]);export{vo as default};
