import{_ as D}from"./AppLayout-1a549d56.js";import{_ as N}from"./PrimaryButton-de7ee4e2.js";import{_ as O}from"./SecondaryButton-514aa4b6.js";import{a as P}from"./DialogModal-0678395e.js";import{_ as S}from"./TextInput-468b09ad.js";import{_ as T}from"./InputError-e6c14c52.js";import{u as z,r as k,a as M,e as F,m as w,s as G}from"./i18n-validators-930275f1.js";import{_ as j}from"./InputLabel-c163595e.js";import{_ as H}from"./Checkbox-59ef8d14.js";import{_ as J}from"./DangerButton-21c3ee21.js";import{k as K,i as Q,I as f,L as W,o as s,c as y,w as p,a as o,D as q,b as i,g as b,e as t,h as u,F as c,t as m,n as C,f as _}from"./app-1a102481.js";import{_ as X}from"./CustomButton-318cd474.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";const Z={setup(){return{v$:z()}},components:{Link:K,CustomButton:X,FontAwesomeIcon:Q,DangerButton:J,Checkbox:H,InputLabel:j,InputError:T,TextInput:S,PrimaryButton:N,SecondaryButton:O,AppLayout:D,DialogModal:P},props:{users:Array,roles:Array,permissions:Array,reports:Array},validations(){return{modal:{form:{id:{requiredIf:k(this.modal.editMode)},name:{required:M},username:{required:M},email:{required:M,email:F},password:{requiredIf:k(this.modal.form.change_password||!this.modal.editMode),minLength:w(8)},confirm_password:{requiredIf:k(this.modal.form.change_password||!this.modal.editMode),sameAs:G(this.modal.form.password),minLength:w(8)},reports:{minLength:w(1)},permissions:{requiredIf:k(this.modal.form.roles.length<1),minLength:w(1)},roles:{requiredIf:k(this.modal.form.permissions.length<1),minLength:w(1)}}}}},data(){return{records:this.users,modal:{title:"",editMode:!1,open:!1,form:{id:"",name:"",username:"",email:"",change_password:!1,password:"",confirm_password:"",reports:[],permissions:[],roles:[]}}}},methods:{create(){this.modal.open=!0,this.modal.title="Crear Usuario"},edit(d){this.modal={title:"Editar Usuario",editMode:!0,open:!0,form:{id:d.id,name:d.name,username:d.username,email:d.email,change_password:!1,password:"",confirm_password:"",reports:d.reports.map(a=>a.id),permissions:d.permissions.map(a=>a.name),roles:d.roles.map(a=>a.name)}}},store(){this.v$.modal.form.$touch(),this.v$.modal.form.$invalid?this.$swal({icon:"error",title:"ERROR",text:"Verifica que toda la información este correctamente diligenciada"}):axios.post(route("users.store"),this.modal.form).then(d=>{this.closeModal(),this.records=d.data}).catch(d=>{this.$swal({icon:"error",title:"ERROR",text:d.response.data})})},update(){this.v$.modal.form.$touch(),this.v$.modal.form.$invalid?this.$swal({icon:"error",title:"ERROR",text:"Verifica que toda la información este correctamente diligenciada"}):axios.put(route("users.update",this.modal.form.id),this.modal.form).then(d=>{this.closeModal(),this.records=d.data}).catch(d=>{this.$swal({icon:"error",title:"ERROR",text:d.response.data})})},destroy(d){this.$swal({icon:"question",title:"¿Eliminar Usuario?",text:"¡Esta acción no es reversible!",showCancelButton:!0,confirmButtonText:"¡Si, Eliminar!"}).then(a=>{a.isConfirmed&&axios.delete(route("users.destroy",d)).then(h=>{this.records=h.data}).catch(h=>{this.$swal({icon:"error",title:"ERROR",text:h.response.data})})})},closeModal(){this.modal={title:"",editMode:!1,open:!1,form:{id:"",name:"",username:"",email:"",change_password:!1,password:"",confirm_password:"",reports:[],permissions:[],roles:[]}},this.v$.modal.form.$reset()}}},ee={class:"flex flex-row"},se=o("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Usuarios del sistema ",-1),oe={class:"py-12"},te={class:"max-w-8xl mx-6 sm:px-6 lg:px-8"},re={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},ae={class:"py-2 align-middle inline-block min-w-full"},le={class:"shadow overflow-hidden border-b border-gray-200 sm:rounded-lg"},ie={class:"min-w-full divide-y divide-gray-200"},ne=o("thead",{class:"bg-gray-50"},[o("tr",null,[o("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}),o("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre "),o("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Usuario "),o("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Correo Electrónico "),o("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Roles Asociados "),o("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Permisos Asociados "),o("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Reportes asociados "),o("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Creado el "),o("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actualizado el ")])],-1),me={class:"bg-white divide-y divide-gray-200"},de={class:"px-6 py-4 text-center text-sm font-medium"},ce={class:"flex flex-row"},ue={class:"px-6 py-4 text-left text-sm font-medium"},pe={class:"px-6 py-4 text-left text-sm font-medium"},fe={class:"px-6 py-4 text-left text-sm font-medium"},_e={class:"px-6 py-4 text-left text-sm font-medium"},xe={class:"text-xs font-semibold inline-block py-1 px-2 rounded text-indigo-600 bg-indigo-200 uppercase last:mr-0 mr-1"},he={key:1,class:"text-xs font-semibold inline-block py-1 px-2 rounded text-red-600 bg-red-200 uppercase last:mr-0 mr-1"},ge={class:"px-6 py-4 text-left text-sm font-medium"},ye={class:"text-xs font-semibold inline-block py-1 px-2 rounded text-indigo-600 bg-indigo-200 uppercase last:mr-0 mr-1"},ve={key:1,class:"text-xs font-semibold inline-block py-1 px-2 rounded text-red-600 bg-red-200 uppercase last:mr-0 mr-1"},ke={class:"px-6 py-4 text-left text-sm font-medium"},we={class:"text-xs font-semibold inline-block py-1 px-2 rounded text-indigo-600 bg-indigo-200 uppercase last:mr-0 mr-1"},be={key:1,class:"text-xs font-semibold inline-block py-1 px-2 rounded text-red-600 bg-red-200 uppercase last:mr-0 mr-1"},Ce={class:"px-6 py-4 text-left text-sm font-medium"},$e={class:"px-6 py-4 text-left text-sm font-medium"},Ve={class:"mt-4"},Re={key:0,class:"mt-1"},Le={class:"mt-4"},Me={key:0,class:"mt-1"},qe={class:"mt-4"},Be={key:0,class:"mt-1"},Ie={key:0,class:"block mt-4"},Ue={class:"flex items-center"},Ae=o("span",{class:"ml-2 text-sm text-gray-600"},"Cambiar contraseña",-1),Ee={class:"mt-4"},De={key:0,class:"mt-1"},Ne={class:"mt-4"},Oe={key:0,class:"mt-1"},Pe={class:"mt-4"},Se={class:"grid grid-cols-3 gap-5 mt-2"},Te={class:"flex items-center"},ze={class:"ml-2"},Fe={key:0,class:"mt-1"},Ge={class:"mt-4"},je={class:"grid grid-cols-3 gap-5 mt-2"},He={class:"flex items-center"},Je={class:"ml-2"},Ke={key:0,class:"mt-1"},Qe={class:"mt-4"},We={class:"grid grid-cols-3 gap-5 mt-2"},Xe={class:"flex items-center"},Ye={class:"ml-2"},Ze={key:0,class:"mt-1"};function es(d,a,h,n,l,g){const V=f("font-awesome-icon"),R=f("PrimaryButton"),B=f("Link"),I=f("CustomButton"),x=f("InputLabel"),v=f("TextInput"),$=f("Checkbox"),U=f("SecondaryButton"),A=f("DialogModal"),E=f("AppLayout"),L=W("permission");return s(),y(E,{title:"Usuarios del sistema"},{header:p(()=>[o("div",ee,[se,q((s(),y(R,{type:"button",class:"ml-auto",onClick:g.create},{default:p(()=>[i(V,{icon:"plus",class:"mr-2"}),b(" Crear ")]),_:1},8,["onClick"])),[[L,"user.create"]])])]),default:p(()=>[o("div",oe,[o("div",te,[o("div",re,[o("div",ae,[o("div",le,[o("table",ie,[ne,o("tbody",me,[(s(!0),t(c,null,u(l.records,e=>(s(),t("tr",null,[o("td",de,[o("div",ce,[q((s(),y(B,{href:d.route("users.show",e.id),class:"mr-2 inline-flex items-center px-2 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-25 transition ease-in-out duration-150"},{default:p(()=>[i(V,{icon:["far","pen-to-square"]})]),_:2},1032,["href"])),[[L,"user.edit"]]),q((s(),y(I,{onClick:r=>g.destroy(e.id)},{default:p(()=>[i(V,{icon:["far","trash-can"]})]),_:2},1032,["onClick"])),[[L,"user.destroy"]])])]),o("td",ue,m(e.name),1),o("td",pe,m(e.username),1),o("td",fe,m(e.email),1),o("td",_e,[e.roles.length>0?(s(!0),t(c,{key:0},u(e.roles,r=>(s(),t("span",xe,m(r.name),1))),256)):(s(),t("span",he," sin roles asociados "))]),o("td",ge,[e.permissions.length>0?(s(!0),t(c,{key:0},u(e.permissions,r=>(s(),t("span",ye,m(r.name),1))),256)):(s(),t("span",ve," sin permisos asociados "))]),o("td",ke,[e.reports.length>0?(s(!0),t(c,{key:0},u(e.reports,r=>(s(),t("span",we,m(r.name),1))),256)):(s(),t("span",be," sin reportes asociados "))]),o("td",Ce,m(e.created_at),1),o("td",$e,m(e.updated_at),1)]))),256))])])])])])])]),i(A,{show:l.modal.open,onClose:g.closeModal},{title:p(()=>[b(m(l.modal.title),1)]),content:p(()=>[o("div",Ve,[i(x,{value:"Nombre"}),i(v,{modelValue:l.modal.form.name,"onUpdate:modelValue":a[0]||(a[0]=e=>l.modal.form.name=e),type:"text",class:C(["mt-1 block w-full",{"border-red-500":n.v$.modal.form.name.$error}]),required:"",autocomplete:"off"},null,8,["modelValue","class"]),n.v$.modal.form.name.$error?(s(),t("ul",Re,[(s(!0),t(c,null,u(n.v$.modal.form.name.$errors,(e,r)=>(s(),t("li",{class:"text-red-500",key:r},m(e.$message),1))),128))])):_("",!0)]),o("div",Le,[i(x,{value:"Usuario"}),i(v,{modelValue:l.modal.form.username,"onUpdate:modelValue":a[1]||(a[1]=e=>l.modal.form.username=e),type:"text",class:C(["mt-1 block w-full",{"border-red-500":n.v$.modal.form.username.$error}]),required:"",autocomplete:"off"},null,8,["modelValue","class"]),n.v$.modal.form.username.$error?(s(),t("ul",Me,[(s(!0),t(c,null,u(n.v$.modal.form.username.$errors,(e,r)=>(s(),t("li",{class:"text-red-500",key:r},m(e.$message),1))),128))])):_("",!0)]),o("div",qe,[i(x,{value:"Correo electrónico"}),i(v,{modelValue:l.modal.form.email,"onUpdate:modelValue":a[2]||(a[2]=e=>l.modal.form.email=e),type:"email",class:C(["mt-1 block w-full",{"border-red-500":n.v$.modal.form.email.$error}]),required:"",autocomplete:"off"},null,8,["modelValue","class"]),n.v$.modal.form.email.$error?(s(),t("ul",Be,[(s(!0),t(c,null,u(n.v$.modal.form.email.$errors,(e,r)=>(s(),t("li",{class:"text-red-500",key:r},m(e.$message),1))),128))])):_("",!0)]),l.modal.editMode?(s(),t("div",Ie,[o("label",Ue,[i($,{checked:l.modal.form.change_password,"onUpdate:checked":a[3]||(a[3]=e=>l.modal.form.change_password=e),name:"change_password"},null,8,["checked"]),Ae])])):_("",!0),l.modal.form.change_password||!l.modal.editMode?(s(),t(c,{key:1},[o("div",Ee,[i(x,{value:"Contraseña"}),i(v,{modelValue:l.modal.form.password,"onUpdate:modelValue":a[4]||(a[4]=e=>l.modal.form.password=e),type:"password",class:C(["mt-1 block w-full",{"border-red-500":n.v$.modal.form.password.$error}]),required:"",autocomplete:"off"},null,8,["modelValue","class"]),n.v$.modal.form.password.$error?(s(),t("ul",De,[(s(!0),t(c,null,u(n.v$.modal.form.password.$errors,(e,r)=>(s(),t("li",{class:"text-red-500",key:r},m(e.$message),1))),128))])):_("",!0)]),o("div",Ne,[i(x,{value:"Confirmar Contraseña"}),i(v,{modelValue:l.modal.form.confirm_password,"onUpdate:modelValue":a[5]||(a[5]=e=>l.modal.form.confirm_password=e),type:"password",class:C(["mt-1 block w-full",{"border-red-500":n.v$.modal.form.confirm_password.$error}]),required:"",autocomplete:"off"},null,8,["modelValue","class"]),n.v$.modal.form.confirm_password.$error?(s(),t("ul",Oe,[(s(!0),t(c,null,u(n.v$.modal.form.confirm_password.$errors,(e,r)=>(s(),t("li",{class:"text-red-500",key:r},m(e.$message),1))),128))])):_("",!0)])],64)):_("",!0),o("div",Pe,[i(x,{value:"Reportes disponibles"}),o("div",Se,[(s(!0),t(c,null,u(h.reports,e=>(s(),t("div",Te,[i($,{checked:l.modal.form.reports,"onUpdate:checked":a[6]||(a[6]=r=>l.modal.form.reports=r),value:e.id},null,8,["checked","value"]),o("div",ze,m(e.name),1)]))),256))]),n.v$.modal.form.reports.$error?(s(),t("ul",Fe,[(s(!0),t(c,null,u(n.v$.modal.form.reports.$errors,(e,r)=>(s(),t("li",{class:"text-red-500",key:r},m(e.$message),1))),128))])):_("",!0)]),o("div",Ge,[i(x,{value:"Roles Disponibles"}),o("div",je,[(s(!0),t(c,null,u(h.roles,e=>(s(),t("div",He,[i($,{checked:l.modal.form.roles,"onUpdate:checked":a[7]||(a[7]=r=>l.modal.form.roles=r),value:e.name},null,8,["checked","value"]),o("div",Je,m(e.name),1)]))),256))]),n.v$.modal.form.roles.$error?(s(),t("ul",Ke,[(s(!0),t(c,null,u(n.v$.modal.form.roles.$errors,(e,r)=>(s(),t("li",{class:"text-red-500",key:r},m(e.$message),1))),128))])):_("",!0)]),o("div",Qe,[i(x,{value:"Permisos Disponibles"}),o("div",We,[(s(!0),t(c,null,u(h.permissions,e=>(s(),t("div",Xe,[i($,{checked:l.modal.form.permissions,"onUpdate:checked":a[8]||(a[8]=r=>l.modal.form.permissions=r),value:e.name},null,8,["checked","value"]),o("div",Ye,m(e.name),1)]))),256))]),n.v$.modal.form.permissions.$error?(s(),t("ul",Ze,[(s(!0),t(c,null,u(n.v$.modal.form.permissions.$errors,(e,r)=>(s(),t("li",{class:"text-red-500",key:r},m(e.$message),1))),128))])):_("",!0)])]),footer:p(()=>[i(U,{onClick:g.closeModal},{default:p(()=>[b(" Cancelar ")]),_:1},8,["onClick"]),l.modal.editMode?(s(),y(R,{key:0,class:"ml-3",onClick:g.update},{default:p(()=>[b(" Actualizar ")]),_:1},8,["onClick"])):(s(),y(R,{key:1,class:"ml-3",onClick:g.store},{default:p(()=>[b(" Guardar ")]),_:1},8,["onClick"]))]),_:1},8,["show","onClose"])]),_:1})}const fs=Y(Z,[["render",es]]);export{fs as default};
