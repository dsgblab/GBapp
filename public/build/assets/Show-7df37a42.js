import{p as h,a2 as C,I as L,o as l,e as i,b as o,u as c,Z as U,a as e,i as x,t as a,w as u,f as p,F as T,g as v,D as k,$ as S,n as Y,h as $,a5 as F}from"./app-d7ce2ef0.js";import{_ as P}from"./PrimaryButton-ea2b215e.js";import{n as B,a as f,m as y,b as z,h as w,u as A}from"./i18n-validators-046e9475.js";import{L as j}from"./Main-c1e7b0a4.js";import{_ as q}from"./CustomButton-06c2a46d.js";import{a as G}from"./DialogModal-2bb32cbd.js";import{_ as W}from"./SecondaryButton-628632fd.js";import{_ as H}from"./Checkbox-d07b95e3.js";const K={class:"min-h-screen bg-gray-100"},Q={class:"py-10 content-center"},Z={class:"max-w-7xl mx-auto"},J={class:"grid grid-cols-2 gap-5 mb-10"},X={class:"flex items-center px-4 py-4 box"},ee={class:"flex-none overflow-hidden rounded-md image-fit items-center justify-center text-slate-700"},te={class:"ml-4 mr-auto"},se={class:"font-medium"},oe=e("div",{class:"text-slate-500 text-xs mt-0.5"},"Razon Social",-1),ae={class:"flex items-center px-4 py-4 box"},re={class:"flex-none overflow-hidden rounded-md image-fit items-center justify-center text-slate-700"},ne={class:"ml-4 mr-auto"},le={class:"font-medium"},ie=e("div",{class:"text-slate-500 text-xs mt-0.5"},"NIT",-1),ce={class:"text-center"},de={class:"overflow-y-auto"},ue={class:"table table-sm table-bordered"},me=e("thead",null,[e("tr",{class:"text-center"},[e("th",{colspan:"3",class:"border-b"}," Producto "),e("th",{colspan:"4",class:"border-b"}," Cantidades "),e("th",{class:"border-b",rowspan:"2"}," Fecha entrega ")]),e("tr",null,[e("th"),e("th",null,"Código"),e("th",null,"Descripción"),e("th",null,"Solicitada"),e("th",null,"Entregada"),e("th",null,"Pendiente"),e("th",null,"Compromiso")])],-1),_e={class:"text-right"},he={class:"text-right"},pe={class:"text-right"},fe=["onUpdate:modelValue"],Ee={key:0,class:"mt-1"},ge={key:0,class:"mt-1"},$e={__name:"Show",props:{registry:Object},setup(E){const N=E,O=h({isCorrect:!1,document:""}),D=h({document:{numeric:B,required:f,minLength:y(9),maxLength:z(9)},row:{registries:{required:f,minLength:y(1),$each:w.forEach({DELIVERY_DATE:{required:f},COMMITTED_AMOUNT:{required:f,minValue:w.withMessage(()=>"No puede ser menor o igual a 0",s=>0<=s),maxValue:w.withMessage(()=>"No puede ser mayor a la cantidad pendiente",(s,{PENDING_AMOUNT:b})=>s<=b)}})}}}),_=h({data:N.registry.orders,columns:["oc","delivery_date","actions"],options:{headings:{oc:"OC",delivery_date:"FECHA ENTREGA",actions:""},clientSorting:!1,uniqueKey:"id",sortable:["oc","delivery_date"]}}),r=h({open:!1,row:{}}),M=()=>{r.open=!1,r.row={}},V=s=>{r.open=!0,r.row=s};A(D,C(O));const d=A(D,C(r)),I=()=>{d.value.$touch(),d.value.$invalid||!r.row.registries.some(s=>s.SELECTED===!0)?Swal.fire({icon:"error",title:"¡Whoops!",text:"Verifica que toda la información este correctamente diligenciada",confirmButtonText:"Aceptar"}):(F.Loading(),axios.post(route("supplier-delivery.update"),r.row).then(s=>{_.data=s.data,Swal.fire({icon:"error",title:"¡Éxito!",text:"Registro actualizado con éxito",confirmButtonText:"Aceptar"})}).catch(s=>{Swal.fire({icon:"error",title:"¡Whoops!",text:s.response.data,confirmButtonText:"Aceptar"})}))};return(s,b)=>{const R=L("v-client-table");return l(),i("div",null,[o(c(U),{title:"Registro"}),e("div",K,[e("div",Q,[e("div",Z,[e("div",J,[e("div",X,[e("div",ee,[o(c(x),{icon:"user",size:"2xl"})]),e("div",te,[e("div",se,a(E.registry.supplier.name),1),oe])]),e("div",ae,[e("div",re,[o(c(x),{icon:"user",size:"2xl"})]),e("div",ne,[e("div",le,a(E.registry.supplier.document),1),ie])])]),o(R,{columns:_.columns,data:_.data,options:_.options,class:"overflow-y-auto w-full"},{actions:u(({row:t})=>[e("div",ce,[o(q,{type:"button",onClick:m=>V(t)},{default:u(()=>[o(c(x),{class:"mr-2",icon:"plus"}),p(" Registrar entrega ")]),_:2},1032,["onClick"])])]),_:1},8,["columns","data","options"])])]),o(G,{show:r.open,onClose:M,"max-width":"7xl"},{title:u(()=>[p(" ORDEN DE COMPRA #"+a(r.row.oc),1)]),content:u(()=>[e("div",de,[e("table",ue,[me,e("tbody",null,[(l(!0),i(T,null,v(r.row.registries,(t,m)=>(l(),i("tr",null,[e("td",null,[o(H,{checked:t.SELECTED,"onUpdate:checked":n=>t.SELECTED=n,name:"remember"},null,8,["checked","onUpdate:checked"])]),e("td",null,a(t.ITEM),1),e("td",null,a(t.PRODUCT_DESCRIPTION)+" – "+a(t.MEASUREMENT),1),e("td",_e,a(parseFloat(t.REQUESTED_AMOUNT)),1),e("td",he,a(parseFloat(t.RECEIVED_AMOUNT)),1),e("td",pe,a(parseFloat(t.PENDING_AMOUNT)),1),e("td",null,[k(e("input",{type:"number",class:Y(["form-control form-control-sm",{"border-red-500":c(d).row.registries.$each.$response.$errors[m].COMMITTED_AMOUNT.length>0}]),"onUpdate:modelValue":n=>t.COMMITTED_AMOUNT=n},null,10,fe),[[S,t.COMMITTED_AMOUNT]]),c(d).row.registries.$each.$response.$errors[m].COMMITTED_AMOUNT.length>0?(l(),i("ul",Ee,[(l(!0),i(T,null,v(c(d).row.registries.$each.$response.$errors[m].COMMITTED_AMOUNT,(n,g)=>(l(),i("li",{key:g,class:"text-red-600"},a(n.$message),1))),128))])):$("",!0)]),e("td",null,[o(j,{modelValue:t.DELIVERY_DATE,"onUpdate:modelValue":n=>t.DELIVERY_DATE=n,options:{autoApply:!0,singleMode:!0,numberOfColumns:1,numberOfMonths:1,showWeekNumbers:!0,format:"DD-MM-YYYY",lang:"es-ES",minDate:t.DELIVERY_DATE},class:"form-control form-control-sm"},null,8,["modelValue","onUpdate:modelValue","options"]),c(d).row.registries.$each.$response.$errors[m].DELIVERY_DATE.length>0?(l(),i("ul",ge,[(l(!0),i(T,null,v(c(d).row.registries.$each.$response.$errors[m].DELIVERY_DATE,(n,g)=>(l(),i("li",{key:g,class:"text-red-600"},a(n.$message),1))),128))])):$("",!0)])]))),256))])])])]),footer:u(()=>[o(W,{onClick:M},{default:u(()=>[p(" Cancelar ")]),_:1}),o(P,{class:"ml-3",onClick:I},{default:u(()=>[p(" Guardar ")]),_:1})]),_:1},8,["show"])])])}}};export{$e as default};
